<div class="doctor-update-container">
  <div class="header">
    <div class="title-section">
      <h2>Novo Médico</h2>
      <p class="subtitle">Cadastre um novo médico no sistema</p>
    </div>
  </div>

  <form [formGroup]="doctorForm" (ngSubmit)="onSubmit()" class="doctor-form mat-elevation-z2">
    <ion-list>
      <ion-item class="form-item">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Nome Completo</mat-label>
          <input matInput formControlName="name" placeholder="Nome do médico" required>
          @if (doctorForm.get('name')?.hasError('required') && doctorForm.get('name')?.touched) {
          <mat-error>O nome é obrigatório.</mat-error>
          }
        </mat-form-field>
      </ion-item>

      <ion-item class="form-item">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>CRM</mat-label>
          <input matInput formControlName="crm" placeholder="CRM do médico" required>
          @if (doctorForm.get('crm')?.hasError('required') && doctorForm.get('crm')?.touched) {
          <mat-error>O CRM é obrigatório.</mat-error>
          }
        </mat-form-field>
      </ion-item>

      <ion-item class="form-item">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Especialidade</mat-label>
          <input matInput formControlName="specialty" placeholder="Especialidade do médico" required>
          @if (doctorForm.get('specialty')?.hasError('required') && doctorForm.get('specialty')?.touched) {
          <mat-error>A especialidade é obrigatória.</mat-error>
          }
        </mat-form-field>
      </ion-item>

      <ion-item class="form-item">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>E-mail</mat-label>
          <input matInput type="email" formControlName="email" placeholder="email@exemplo.com" required email>
          @if (doctorForm.get('email')?.hasError('required') && doctorForm.get('email')?.touched) {
          <mat-error>O e-mail é obrigatório.</mat-error>
          }
          @if (doctorForm.get('email')?.hasError('email') && doctorForm.get('email')?.touched) {
          <mat-error>Por favor, insira um e-mail válido.</mat-error>
          }
        </mat-form-field>
      </ion-item>

      <ion-item class="form-item">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Telefone</mat-label>
          <input matInput formControlName="phone" placeholder="(XX) XXXXX-XXXX">
        </mat-form-field>
      </ion-item>

      <ion-item class="form-item">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Cliente (obrigatório)</mat-label>
          <mat-select formControlName="clientId" required>
            @if (clients.length === 0) {
              <mat-option disabled>Carregando clientes...</mat-option>
            } @else {
              <mat-option *ngFor="let client of clients" [value]="client.id">
                ID: {{ client.id }} - {{ client.name }} {{ client.email ? '(' + client.email + ')' : '' }}
              </mat-option>
            }
          </mat-select>
          <mat-hint>Selecione o cliente ao qual este médico será vinculado</mat-hint>
          <mat-error *ngIf="doctorForm.get('clientId')?.hasError('required')">
            É necessário vincular o médico a um cliente
          </mat-error>
        </mat-form-field>
      </ion-item>
    </ion-list>

    <div class="form-actions">
      <button mat-raised-button color="warn" type="button" (click)="onCancel()">
        <mat-icon>cancel</mat-icon>
        <span>Cancelar</span>
      </button>
      <button mat-raised-button color="primary" type="submit" [disabled]="doctorForm.invalid">
        <mat-icon>save</mat-icon>
        <span>Cadastrar Médico</span>
      </button>
    </div>
  </form>
</div>
