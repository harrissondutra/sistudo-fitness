<div class="client-container">
  <div class="header">
    <mat-icon>person</mat-icon>
    <div class="header-content">
      <h1>{{ client?.name }}</h1>
      <p class="subtitle">Detalhes do Cliente</p>
    </div>
  </div>

  @if (client) {
  <div class="content">
    <div class="info-section">
      <h2>
        <mat-icon>info</mat-icon>
        Informações Pessoais
      </h2>
      <div class="info-grid">
        <div class="info-item">
          <span class="label">E-mail:</span>
          <span class="value">{{ client.email }}</span>
        </div>
        <!-- <div class="info-item">
            <span class="label">Telefone:</span>
            <span class="value">{{ client.phone }}</span>
          </div> -->
        <div class="info-item">
          <span class="label">Data de Nascimento:</span>
          <span class="value">{{ client.dateOfBirth | date:'dd/MM/yyyy' }}</span>
        </div>
        <div class="info-item">
          <span class="label">Altura:</span>
          <span class="value">{{ client.height }} cm</span>
        </div>
        <div class="info-item">
          <span class="label">Peso:</span>
          <span class="value">{{ client.weight }} kg</span>
        </div>
      </div>
    </div>

    <div class="measures-section">
      <h2>
        <mat-icon>fitness_center</mat-icon>
        Medidas Atuais
      </h2>
      <div class="measures-grid">
        <div class="measure-group">
          <h3>Medidas do Corpo</h3>
          <div class="measure-row">
            <div class="measure-item">
              <span class="label">Ombro:</span>
              <span class="value">{{ formatMeasure(client.measure?.ombro) }} cm</span>
            </div>
            <div class="measure-item">
              <span class="label">Peitoral:</span>
              <span class="value">{{ formatMeasure(client.measure?.peitoral) }} cm</span>
            </div>
          </div>
          <div class="measure-row">
            <div class="measure-item">
              <span class="label">Cintura:</span>
              <span class="value">{{ formatMeasure(client.measure?.cintura) }} cm</span>
            </div>
            <div class="measure-item">
              <span class="label">Quadril:</span>
              <span class="value">{{ formatMeasure(client.measure?.quadril) }} cm</span>
            </div>
          </div>
          <div class="measure-row">
            <div class="measure-item">
              <span class="label">Abdômen:</span>
              <span class="value">{{ formatMeasure(client.measure?.abdomem) }} cm</span>
            </div>
            <div class="measure-item">
              <span class="label">Tórax:</span>
              <span class="value">{{ formatMeasure(client.measure?.torax) }} cm</span>
            </div>
          </div>
        </div>
        <div class="measure-group">
          <h3>Medidas dos Membros</h3>
          <div class="measure-row">
            <div class="measure-item">
              <span class="label">Braço Direito:</span>
              <span class="value">{{ formatMeasure(client.measure?.bracoDireito) }} cm</span>
            </div>
            <div class="measure-item">
              <span class="label">Braço Esquerdo:</span>
              <span class="value">{{ formatMeasure(client.measure?.bracoEsquerdo) }} cm</span>
            </div>
          </div>
          <div class="measure-row">
            <div class="measure-item">
              <span class="label">Coxa Direita:</span>
              <span class="value">{{ formatMeasure(client.measure?.coxaDireita) }} cm</span>
            </div>
            <div class="measure-item">
              <span class="label">Coxa Esquerda:</span>
              <span class="value">{{ formatMeasure(client.measure?.coxaEsquerda) }} cm</span>
            </div>
          </div>
          <div class="measure-row">
            <div class="measure-item">
              <span class="label">Panturrilha Direita:</span>
              <span class="value">{{ formatMeasure(client.measure?.panturrilhaDireita) }} cm</span>
            </div>
            <div class="measure-item">
              <span class="label">Panturrilha Esquerda:</span>
              <span class="value">{{ formatMeasure(client.measure?.panturrilhaEsquerda) }} cm</span>
            </div>
          </div>
        </div>
        <div class="measure-group">
          <h3>Dobras Cutâneas</h3>
          <div class="measure-row">
            <div class="measure-item">
              <span class="label">Abdominal:</span>
              <span class="value">{{ formatMeasure(client.measure?.abdominal) }} mm</span>
            </div>
            <div class="measure-item">
              <span class="label">Suprailíaca:</span>
              <span class="value">{{ formatMeasure(client.measure?.suprailiaca) }} mm</span>
            </div>
          </div>
          <div class="measure-row">
            <div class="measure-item">
              <span class="label">Subescapular:</span>
              <span class="value">{{ formatMeasure(client.measure?.subescapular) }} mm</span>
            </div>
            <div class="measure-item">
              <span class="label">Tríceps:</span>
              <span class="value">{{ formatMeasure(client.measure?.triceps) }} mm</span>
            </div>
          </div>
          <div class="measure-row">
            <div class="measure-item">
              <span class="label">Axilar Média:</span>
              <span class="value">{{ formatMeasure(client.measure?.axilar) }} mm</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    @if (client.evolutionPhotos?.length) {
    <div class="photos-section">
      <h2>
        <mat-icon>photo_camera</mat-icon>
        Fotos de Evolução
      </h2>
      <div class="photos-grid">
        @for (photo of client.evolutionPhotos; track $index) {
        <div class="photos-grid">
          @for (photoUrl of client.evolutionPhotos; track $index) {
          <div class="photo-card">
            <img [src]="photoUrl" [alt]="'Foto de evolução do cliente'">
          </div>
          }
        </div>
        }
      </div>
    </div>
    }

    <div class="trainings-section">
      <h2>
        <mat-icon>fitness_center</mat-icon>
        Treinos
      </h2>
      <mat-tab-group>
        <mat-tab label="Treino Atual">
          @if (currentTraining) {
          <div class="current-training">
            <div class="training-info">
              <p><strong>Início:</strong> {{ currentTraining.startDate | date:'dd/MM/yyyy' }}</p>
            </div>
          </div>
          }
          @if (!currentTraining) {
          <div class="no-training">
            <p>Nenhum treino em andamento</p>
          </div>
          }
        </mat-tab>

        <mat-tab label="Histórico">
          <div class="training-history">
            <table mat-table [dataSource]="trainingHistory" class="training-table">
              <ng-container matColumnDef="startDate">
                <th mat-header-cell *matHeaderCellDef>Início</th>
                <td mat-cell *matCellDef="let training">{{ training.startDate | date:'dd/MM/yyyy' }}</td>
              </ng-container>
              <ng-container matColumnDef="endDate">
                <th mat-header-cell *matHeaderCellDef>Fim</th>
                <td mat-cell *matCellDef="let training">{{ training.endDate ? (training.endDate | date:'dd/MM/yyyy') : '-' }}</td>
              </ng-container>
              <ng-container matColumnDef="goal">
                <th mat-header-cell *matHeaderCellDef>Objetivo</th>
                <td mat-cell *matCellDef="let training">{{ training.goal }}</td>
              </ng-container>
              <ng-container matColumnDef="actions">
                <th mat-header-cell *matHeaderCellDef>Ações</th>
                <td mat-cell *matCellDef="let training">
                  <button mat-icon-button color="primary" (click)="viewTrainingDetails(training)">
                    <mat-icon>visibility</mat-icon>
                  </button>
                </td>
              </ng-container>
              <tr mat-header-row *matHeaderRowDef="trainingColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: trainingColumns;"></tr>
              <tr class="mat-row no-data-row" *matNoDataRow>
                <td class="mat-cell" colspan="4">Nenhum histórico de treino disponível.</td>
              </tr>
            </table>
          </div>
        </mat-tab>
      </mat-tab-group>
    </div>
  </div>
  }

  <div class="actions">
    <button mat-button (click)="onBack()">
      <mat-icon>arrow_back</mat-icon>
      Voltar
    </button>
    <button mat-raised-button color="primary" (click)="onEdit()">
      <mat-icon>edit</mat-icon>
      Editar Cliente
    </button>
  </div>
</div>
